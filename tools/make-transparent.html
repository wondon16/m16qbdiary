<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Make Logo Transparent</title>
  <style>
    body{margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#0b1e3a; color:#e6f7ff; display:grid; place-items:center; min-height:100vh}
    .card{background:rgba(15,43,83,.7); border:1px solid #163556; border-radius:14px; padding:16px; width:min(720px,92vw); box-shadow:0 20px 60px rgba(0,0,0,.35)}
    .row{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    .btn{appearance:none; border:none; border-radius:999px; padding:10px 14px; font-weight:800; cursor:pointer; color:#052244; background:linear-gradient(180deg,#62c7ff,#2aa3ff)}
    .muted{color:#a9c9f9; font-size:13px}
    canvas{max-width:100%; background:#0a1a33; border-radius:10px}
    label{font-weight:700}
    input[type="range"]{width:180px}
  </style>
  <link rel="preload" as="image" href="../quarterback pocketbook/logo22.png">
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const imgPath = '../quarterback pocketbook/logo22.png';
      const outName = 'logo22_transparent.png';
      const img = new Image(); img.crossOrigin = 'anonymous'; img.src = imgPath;
      const canvas = document.getElementById('cv'); const ctx = canvas.getContext('2d');
      const fuzzEl = document.getElementById('fuzz'); const tolEl = document.getElementById('tol');
      const dlBtn = document.getElementById('dl');

      function process() {
        const w = img.naturalWidth, h = img.naturalHeight; if (!w || !h) return;
        canvas.width = w; canvas.height = h; ctx.clearRect(0,0,w,h); ctx.drawImage(img,0,0);
        const imgData = ctx.getImageData(0,0,w,h); const d = imgData.data;
        const fuzz = Number(fuzzEl.value); // 0..100 (% whiteness tolerance)
        const soft = Number(tolEl.value);  // 0..100 (edge softness)
        for (let i = 0; i < d.length; i += 4) {
          const r = d[i], g = d[i+1], b = d[i+2];
          // whiteness score: 0 (black) .. 1 (white)
          const maxc = Math.max(r,g,b), minc = Math.min(r,g,b);
          const lum = (r+g+b)/ (255*3);
          const sat = (maxc === 0) ? 0 : (maxc - minc) / maxc; // 0 = grey/white
          // Pixels that are bright with low saturation are near-white
          const whiteScore = lum * (1 - sat);
          const thr = fuzz/100;
          let a = d[i+3];
          if (whiteScore >= thr) {
            // Soft fade based on how close to white vs threshold
            const softness = soft/100;
            const t = Math.min(1, (whiteScore - thr) / Math.max(1e-6, 1 - thr));
            const fade = (1 - Math.pow(1 - t, 2)) * softness + (softness > 0 ? 0 : 1);
            a = Math.round(a * (1 - fade));
          }
          d[i+3] = a;
        }
        ctx.putImageData(imgData, 0, 0);
      }

      img.addEventListener('load', process);
      fuzzEl.addEventListener('input', process);
      tolEl.addEventListener('input', process);

      dlBtn.addEventListener('click', () => {
        // Download as a file; then place it into the project at quarterback pocketbook/logo22_transparent.png
        const a = document.createElement('a');
        a.download = outName;
        a.href = canvas.toDataURL('image/png');
        a.click();
      });
    });
  </script>
</head>
<body>
  <div class="card">
    <h2>Generate Transparent Logo</h2>
    <p class="muted">This tool removes white/near-white from <code>quarterback pocketbook/logo22.png</code> and lets you download <code>logo22_transparent.png</code>.</p>
    <div class="row" style="margin:8px 0 10px">
      <label>Whiteness tolerance:&nbsp;<input id="fuzz" type="range" min="50" max="100" value="92"></label>
      <label>Edge softness:&nbsp;<input id="tol" type="range" min="0" max="100" value="40"></label>
      <button id="dl" class="btn">Download Transparent PNG</button>
    </div>
    <canvas id="cv"></canvas>
    <p class="muted">After download, move the file into <code>quarterback pocketbook/logo22_transparent.png</code>. The site is already wired to use it when present.</p>
  </div>
</body>
</html>

